# カード生成

<!-- toc -->

## リバースカード

YouTubeで[リバースカードについてのビデオ](http://www.youtube.com/watch?v=DnbKwHEQ1mA&yt:cc=on)を見ることができます。

カードを両方向に進むように作成したい場合（例：「ookii」→「big」と「big」→「ookii」）、いくつかのオプションがあります。最も簡単なのは、「Basic (and reversed card)」という組み込みのノートタイプを選択することです。これにより、各方向に1枚ずつ、合計2枚のカードが生成されます。

教材の一部に対してのみリバースカードを生成したい場合（例えば、最も重要な教材に対してのみリバースカードを学習したい場合や、一部のカードが逆にすると意味をなさない場合）、"Basic (optional reversed card)" ノートタイプを選択できます。このノートタイプは、最初の2つのフィールドにのみ記入すると、順方向のカードのみを生成します。さらに「Add Reverse」フィールドに何か（例えば 'y'）を入力すると、Ankiはリバースカードも生成します。このフィールドの内容はカードには表示されません。

## カードの生成と削除

Ankiは、表側が空のカードを作成しません。したがって、「My Field」が空であり、カードの表テンプレートにそのフィールドのみが含まれている場合、そのカードは作成されません。

以前に追加したノートを編集すると、Ankiは以前は空だったが現在は空でなくなったカードを自動的に作成します。しかし、編集によって以前は空でなかったカードが空になった場合、Ankiはそれらをすぐには削除しません。これは、誤ってデータを失う可能性があるためです。空のカードを削除するには、メインウィンドウで「ツール」→「空のカード」を選択します。空のカードのリストが表示され、削除するオプションが提供されます。

カード生成の仕組みのため、個々のカードを手動で削除することはできません。ノートを編集するたびに再生成されてしまうからです。代わりに、関連する条件付き置換フィールドを空にしてから、空のカードオプションを使用する必要があります。

Ankiは、カード生成の目的で特殊フィールドやフィールド以外のテキストを考慮しません。したがって、表テンプレートが次のようになっている場合、Countryが空であればカードは生成されません：

    Where is {{Country}} on the map?

## 選択的なカード生成

時々、セットの中で最も重要な単語を思い出す能力をテストするなど、一部の教材に対してのみ追加のカードを生成したい場合があります。これを実現するには、ノートに追加のフィールドを追加し、追加のカードが欲しいノートにテキスト（例えば「1」）を入力します。次に、カードテンプレートで、そのフィールドが空でない場合にカードが生成されるように設定できます。詳細については、以下の条件付き置換セクションを参照してください。

## 条件付き置換

フィールドが空であるか空でないかに応じて、特定のテキスト、フィールド、またはHTMLをカードに含めることができます。例：

    このテキストは常に表示されます。

    {{#FieldName}}
        このテキストはFieldNameにテキストが含まれている場合にのみ表示されます
    {{/FieldName}}

    {{^FieldName}}
        このテキストはFieldNameが空の場合にのみ表示されます
    {{/FieldName}}

実際の例として、フィールドが空でない場合にラベルを表示する方法：

    {{#Tags}}
        タグ: {{Tags}}
    {{/Tags}}

または、カードの裏に追加のノートがある場合に、カードの表に特定のフィールドを青色で表示したい場合（ノートがあることが、答えを考えるのにもっと時間をかけるべきだというリマインダーとして機能するかもしれません）。次のようにフィールドをスタイル設定できます：

    {{#Notes}}
        <span style="color:blue;">
    {{/Notes}}

    {{FieldToFormat}}

    {{#Notes}}
        </span>
    {{/Notes}}

条件付き置換を使用して、生成されるカードを制御することもできます。これは、Ankiが表側が空のカードを生成しないために機能します。例えば、表に2つのフィールドがあるカードを考えてみましょう：

    {{Expression}}
    {{Notes}}

通常、表現フィールドまたはノートフィールドにテキストが含まれていればカードが生成されます。表現フィールドが空でない場合にのみカードを生成したい場合は、テンプレートを次のように変更できます：

    {{#Expression}}
        {{Expression}}
        {{Notes}}
    {{/Expression}}

両方のフィールドが必要な場合は、2つの条件付き置換を使用できます：

    {{#Expression}}
        {{#Notes}}
            {{Expression}}
            {{Notes}}
        {{/Notes}}
    {{/Expression}}

この方法が機能するのは、条件付き置換コードをカードの「表側」に配置した場合のみであることに注意してください。これを裏側に配置すると、裏側が空白のカードが生成されるだけです。同様に、これは表フィールドが空であるかどうかを確認することで機能するため、表側全体を条件付き置換で囲むことが重要です。例えば、次のようにすると期待通りに動作しません：

    {{#Expression}}
        {{Expression}}
    {{/Expression}}
    {{Notes}}

## 裏面が空白の場合

カード生成はカードの表側のみを確認します。例えば、次のような表テンプレートがある場合：

    {{Field 1}}

そして裏テンプレートが次のようになっている場合：

    {{Field 2}}

Field 1が空でない場合、カードが生成されます。Field 2が空の場合でも、カードは生成され、裏面が空白になります。

裏面が空白になるのを避けたい場合は、表テンプレートに条件付きで必須フィールドを配置する必要があります。例えば、次のようにします：

    {{#Field 2}}
        {{Field 1}}
    {{/Field 2}}

これにより、Field 2とField 1の両方が空でない場合にのみカードが生成されるようになります。

## 古いAnkiバージョンの制限

以下の制限は、Anki 2.1.28+およびAnkiMobile 2.0.64+には適用されません。

古いAnkiバージョンでは、カード生成に否定条件を使用できません。例えば、Anki 2.1.28では、次のように記述すると、AddIfEmptyというフィールドが空であり、Frontが空でない場合にカードが追加されます：

    {{^AddIfEmpty}}
        {{Front}}
    {{/AddIfEmpty}}

以前のAnkiバージョンでは、否定条件が無視され、カード生成はFrontが空でないかどうかにのみ依存します。

**AND**条件と**OR**条件を混在させることも、古いバージョンでは問題を引き起こす可能性があります。例えば、次のように記述すると（「A**または**B**または**Cが空でない場合にカードを追加」）、問題ありません：

    {{A}}
    {{B}}
    {{C}}

次のように記述すると（「A**かつ**B**かつ**Cが空でない場合にカードを追加」）、問題ありません：

    {{#A}}
        {{#B}}
            {{#C}}
                {{A}}
            {{/C}}
        {{/B}}
    {{/A}}

しかし、次のように記述すると（「A**または**（B**かつ**C）が空でない場合にカードを追加」）、正しく動作しません：

    {{A}}
    {{#B}}
        {{#C}}
            {{B}}
        {{/C}}
    {{/B}}

## 空のノートの追加

Anki 2.1.28+ および AnkiMobile 2.0.64+ で新しいノートを追加する際に、カードテンプレートとノートフィールドが組み合わさってカードが生成されない場合、最初のテンプレートを使用して空のカードが作成されます。これにより、内容が不完全であっても素材を追加し、後でそれを修正したりテンプレートを変更したりして有効にすることができます。空のノートを保持したくない場合は、空のカード機能を使用して削除できます。

古いAnkiバージョンでは、カードが生成されない場合、Ankiはノートの追加やインポートを拒否します。

## クロズテンプレート

背景情報については、[穴埋め問題](../editing.md#穴埋め問題)セクションを参照してください。

クロズノートタイプは通常のノートタイプとは異なる機能を持ちます。カスタマイズ可能なカードタイプの数の代わりに、ノート上のすべてのクロズ削除で共有される単一のタイプを持ちます。

上記のカード生成セクションで述べたように、通常のカードの生成は質問の1つ以上のフィールドが空でないことに依存します。クロズ削除ノートタイプは異なる方法で生成されます：

- Ankiは表テンプレートで1つ以上のクロズ置換（例：{{cloze:FieldName}}）を探します。

- 次に、FieldNameフィールド内のすべてのクロズ参照（例：{{c1::テキスト}}）を探します。

- 異なる番号ごとにカードが生成されます。

カード生成がクロズ削除カードに対して異なる方法で機能するため、{{cloze:…​}}タグは通常のノートタイプでは使用できません。これらはクロズノートタイプで使用する場合にのみ正しく機能します。

条件付き生成は、レンダリングしているカードを確認するための特別なフィールドを提供します。例えば、最初のクロズに「hint1」フィールドを表示し、2番目のクロズに「hint2」フィールドを表示したい場合、次のテンプレートを使用できます：

    {{cloze:Text}}

    {{#c1}}
        {{Hint1}}
    {{/c1}}

    {{#c2}}
        {{Hint2}}
    {{/c2}}